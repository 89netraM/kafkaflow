"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[708],{3905:(e,r,t)=>{t.d(r,{Zo:()=>l,kt:()=>m});var s=t(7294);function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,s)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function i(e,r){if(null==e)return{};var t,s,n=function(e,r){if(null==e)return{};var t,s,n={},o=Object.keys(e);for(s=0;s<o.length;s++)t=o[s],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)t=o[s],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var p=s.createContext({}),c=function(e){var r=s.useContext(p),t=r;return e&&(t="function"==typeof e?e(r):a(a({},r),e)),t},l=function(e){var r=c(e.components);return s.createElement(p.Provider,{value:r},e.children)},d={inlineCode:"code",wrapper:function(e){var r=e.children;return s.createElement(s.Fragment,{},r)}},u=s.forwardRef((function(e,r){var t=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),u=c(t),m=n,f=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return t?s.createElement(f,a(a({ref:r},l),{},{components:t})):s.createElement(f,a({ref:r},l))}));function m(e,r){var t=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var o=t.length,a=new Array(o);a[0]=u;var i={};for(var p in r)hasOwnProperty.call(r,p)&&(i[p]=r[p]);i.originalType=e,i.mdxType="string"==typeof e?e:n,a[1]=i;for(var c=2;c<o;c++)a[c]=t[c];return s.createElement.apply(null,a)}return s.createElement.apply(null,t)}u.displayName="MDXCreateElement"},8820:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>p,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var s=t(7462),n=(t(7294),t(3905));const o={sidebar_position:3},a="Compressor",i={unversionedId:"guides/compressor",id:"guides/compressor",title:"Compressor",description:"Native Compressor",source:"@site/docs/guides/compressor.md",sourceDirName:"guides",slug:"/guides/compressor",permalink:"/docs/guides/compressor",draft:!1,editUrl:"https://github.com/farfetch/kafkaflow/tree/master/website/docs/guides/compressor.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Authentication",permalink:"/docs/guides/authentication"},next:{title:"Consumers",permalink:"/docs/guides/consumers"}},p={},c=[{value:"Native Compressor",id:"native-compressor",level:2},{value:"Compressor Middleware",id:"compressor-middleware",level:2}],l={toc:c};function d(e){let{components:r,...t}=e;return(0,n.kt)("wrapper",(0,s.Z)({},l,t,{components:r,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"compressor"},"Compressor"),(0,n.kt)("h2",{id:"native-compressor"},"Native Compressor"),(0,n.kt)("p",null,"It is the easier and native way of compressing messages, the compression and decompression are done by the Confluent Kafka client, without any interference by KafkaFlow. The setup must be done only in the producers, the consumers will identify compressed messages and decompress them automatically."),(0,n.kt)("p",null,"The following compression types are supported:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Gzip"),(0,n.kt)("li",{parentName:"ul"},"Snappy"),(0,n.kt)("li",{parentName:"ul"},"Lz4"),(0,n.kt)("li",{parentName:"ul"},"Zstd")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csharp"},'public class Startup\n{\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddKafka(kafka => kafka\n            .AddCluster(cluster => cluster\n                .WithBrokers(new[] { "localhost:9092" })\n                .AddProducer<ProductEventsProducer>(producer => producer\n                    .WithCompression(CompressionType.Gzip)\n                        ...\n                    )\n                )\n            )\n        );\n    }\n}\n')),(0,n.kt)("h2",{id:"compressor-middleware"},"Compressor Middleware"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"It is highly recommended to use the producer native compression instead of using the compressor middleware")),(0,n.kt)("p",null,"It is a middleware used to compress and decompress messages. Install the ",(0,n.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/KafkaFlow.Compressor/"},"KafkaFlow.Compressor")," package and add the ",(0,n.kt)("inlineCode",{parentName:"p"},"AddCompressor")," extension method to your producer/consumer middlewares to use it. The method receives a class that implements the ",(0,n.kt)("inlineCode",{parentName:"p"},"IMessageCompressor")," interface as a generic argument, this class will be used in the compress/decompress process. A class instance can be passed as a normal argument through a factory method too. Install the ",(0,n.kt)("a",{parentName:"p",href:"https://www.nuget.org/packages/KafkaFlow.Compressor.Gzip/"},"KafkaFlow.Compressor.Gzip")," to use the ",(0,n.kt)("inlineCode",{parentName:"p"},"GzipMessageCompressor")," that uses the GZIP algorithm."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csharp"},'public class Startup\n{\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddKafka(kafka => kafka\n            .AddCluster(cluster => cluster\n                .WithBrokers(new[] { "localhost:9092" })\n                .AddProducer<ProductEventsProducer>(producer => producer\n                    ...\n                    .AddMiddlewares(middlewares => middlewares\n                        ...\n                        .AddCompressor<GzipMessageCompressor>()\n                        // or\n                        .AddCompressor(resolver => new GzipMessageCompressor(...))\n                        ...\n                    )\n                )\n            )\n        );\n    }\n}\n')))}d.isMDXComponent=!0}}]);